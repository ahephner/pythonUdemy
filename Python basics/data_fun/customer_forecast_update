import pandas as pd 

#files import and read
goal = r"C:\Users\AJ Hephner\Documents\2019\All Customer Goals\Customer Goals.csv"
doc = r"C:\Users\AJ Hephner\Documents\2019\All Customer Goals\Sales Doc 5_6.csv"
land = r"C:\Users\AJ Hephner\Documents\2019\All Customer Goals\landing.csv"
snapshot = r"C:\Users\AJ Hephner\Documents\2019\All Customer Goals\lastRun56.csv"
cg = pd.read_csv(goal)
sd = pd.read_csv(doc)


#Clean goals prep for join 
cg.head(4)
cg = cg.fillna(0)
cg.info()

#group up docs
sd.head(1)

sd = sd.groupby(['Customer__c', 'Sales_Rep__c']).sum().reset_index()
sd.head(4)
sd = sd.rename(columns={'Customer__c' : 'Customer','Sales_Rep__c' : 'Sales Rep' })

#Testing above method
#select a large sales customer data frame and go find if there are multiple reps selling to it on the spreadsheet
#not a great method need to improve
#test = sd[(sd['Product_Sub_Total__c']> 50000)]
#test.head()
#A large customer 
#multi = sd[(sd['Customer__c'] == '0014100000O8GRbAAN')]
#multi.head()

#merge df's
merged = sd.merge(cg,on=['Customer', 'Sales Rep'] )
merged.head(1)
merged['Total Sales'] = merged['Product_Sub_Total__c']
merged.head(5)

#move merged file to start being able to run this query on sales docs from 5/6 foward vs. entire year. 
# Save this 'snapshot' file in your computer to save as a time frame ref. 
merged.to_csv(snapshot, index=False)

final = merged[['Record ID', 'Product_Sub_Total__c']]
final = final.rename(columns={'Product_Sub_Total__c': 'Total_Sales__c'})
#bye
final.to_csv(land)


#find cust with multiple sales goals attached
# cust = {}
# col = cg['Customer']

# for i in col.keys():
#     if i in cust.keys():
#         cust[x] += 1
#     else:
#         cust[x] = 1

# df = pd.DataFrame.from_dict(cust)
# df = df[df[0]> 1]

# print(df)
